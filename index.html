<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Football Tactical Board</title>
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #1b1b1b;
  color: white;
}

#toolbar {
  padding: 10px;
  background: #111;
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

button {
  padding: 6px 10px;
  cursor: pointer;
  border: none;
  background: #2ecc71;
  color: black;
  font-weight: bold;
}

#board {
  position: relative;
  width: 100%;
  max-width: 900px;
  height: 520px;
  margin: 20px auto;
  background: #2e8b57;
  border: 4px solid white;
}

.player, .ball {
  position: absolute;
  border-radius: 50%;
  cursor: pointer;
}

.player {
  width: 28px;
  height: 28px;
  background: #3498db;
  border: 2px solid white;
}

.ball {
  width: 18px;
  height: 18px;
  background: white;
}

canvas {
  position: absolute;
  top: 0;
  left: 0;
}
</style>
</head>

<body>

<div id="toolbar">
  <button onclick="setMode('player')">Player</button>
  <button onclick="setMode('ball')">Ball</button>
  <button onclick="setMode('line')">Line</button>
  <button onclick="undo()">Undo</button>
  <button onclick="clearBoard()">Clear</button>
  <button onclick="exportPNG()">Export PNG</button>
</div>

<div id="board">
  <canvas id="drawCanvas"></canvas>
</div>

<script>
const board = document.getElementById("board");
const canvas = document.getElementById("drawCanvas");
const ctx = canvas.getContext("2d");

canvas.width = board.clientWidth;
canvas.height = board.clientHeight;

let mode = "player";
let history = [];
let drawing = false;
let startX, startY;

function setMode(m) {
  mode = m;
}

board.addEventListener("click", e => {
  if (mode === "player") addElement("player", e);
  if (mode === "ball") addElement("ball", e);
});

function addElement(type, e) {
  const el = document.createElement("div");
  el.className = type;
  el.style.left = e.offsetX - 14 + "px";
  el.style.top = e.offsetY - 14 + "px";
  board.appendChild(el);
  history.push(el);
}

canvas.addEventListener("mousedown", e => {
  if (mode !== "line") return;
  drawing = true;
  startX = e.offsetX;
  startY = e.offsetY;
});

canvas.addEventListener("mouseup", e => {
  if (!drawing) return;
  drawing = false;
  ctx.beginPath();
  ctx.moveTo(startX, startY);
  ctx.lineTo(e.offsetX, e.offsetY);
  ctx.strokeStyle = "white";
  ctx.lineWidth = 3;
  ctx.stroke();
  history.push("line");
});

function undo() {
  const last = history.pop();
  if (!last) return;
  if (last === "line") {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  } else {
    last.remove();
  }
}

function clearBoard() {
  document.querySelectorAll(".player, .ball").forEach(el => el.remove());
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  history = [];
}

function exportPNG() {
  const tempCanvas = document.createElement("canvas");
  tempCanvas.width = canvas.width;
  tempCanvas.height = canvas.height;
  const tctx = tempCanvas.getContext("2d");

  tctx.fillStyle = "#2e8b57";
  tctx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
  tctx.drawImage(canvas, 0, 0);

  const link = document.createElement("a");
  link.download = "tactics.png";
  link.href = tempCanvas.toDataURL();
  link.click();
}
</script>

</body>
</html>
